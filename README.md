# Excel Parser

The project is generated by [LoopBack](http://loopback.io).

This application parses the uploaded excel file and provides the json object of the uploaded file.

This is usefull when you try upload records via excel, you can use the generated json object and iterate through it and can create records accordingly.


Apart from parsing the excel you can also download the template excel file for uploading the records,

NOTE: The empty fields (i.e) fields with no values in them has to be mentioned `null`.

you use the excelParser.js (which has the logic) in your own project in such case make sure you have all the dependencies installed.

## Dependencies

1. async
2. xlsx https://www.npmjs.com/package/xlsx
3. multer
4. loadsh
5. fs & path


for this demo application to work create a postgresql database with excel_demo_database, you can change the model config as per you wish.



## Installation

```bash
npm install
```

## Running the Application
move into the main project
```bash
node .
```


## Excel Parser

for parsing the uploaded excel

```bash
var headers = ["your", "array", "of", "headers", "for your", "excel"];
excelParser.parse(headers, req, res, function(err, data){
  if (err){
    return yourCallback(err, null);
  }
  yourCallback(null, data);
});
```
```

make sure you pass the array, this array is used to cross check whether the uploaded excel file has required format of headers and the json object generated also has effect on it.


for downloading the template

```bash

excelParser.downloadExcel(headers, 'name_of_the_file_to_be_dowloaded', req, res, function(err, data){
  if (err){
    return yourCallback(err, null);
  }
});

```
